<!doctype html>
<html>
<head>
<script type="text/javascript">
/**
 * SSLSTripWire Popup
 * @author Ameer Ayoub <ameer.ayoub@gmail.com>
 * @package SSLSTripWire
 *
 * Call to chrome API for currently selected tab (the caller) and callback
 * with tab information, then call to sslstripwire and get back the stats from
 * the site_db, then process info and write out to popup.
 */
function init(){
	chrome.tabs.getSelected(null, function(tab){
		var bgPage = chrome.extension.getBackgroundPage();
		bgPage.sslstripwire.webdb.getSiteStats(tab.url, function(tx, result){
			if(result.rows.length > 0){
				https_count = result.rows.item(0).https_count;
				http_count = result.rows.item(0).http_count;
				document.write("<pre>Domain: "+bgPage.sslstripwire.helpers.getDomain(tab.url)+"\nHTTP: "+http_count + "\nHTTPS: " + https_count);
			} else {
				document.write("Info not available");
			}
		});
	});
}
</script>
</head>
<body onLoad="init()">
</body>
</html>
